turn_off_everything:
  alias: Turn Off Everything
  icon: mdi:door-open
  sequence:
  - service: script.turn_off_lights
  - service: script.turn_off_all_presences
  - service: script.turn_off_all_presence_locks
  - service: script.turn_off_all_music
  - service: humidifier.turn_off
    target:
      entity_id: humidifier.humidifier
  - service: script.set_heating_to_auto
  - service: script.set_heating_to_away_mode
  - service: input_boolean.turn_off
    target:
      entity_id:
        - input_boolean.work_mode
        - input_boolean.guest_mode
  mode: single

turn_off_lights:
  alias: Turn Off Lights
  sequence:
    - service: light.turn_off
      target:
        entity_id: 'all'
    - service: switch.turn_off
      target:
        entity_id:
          - switch.entrance_lamp
          - switch.fairy_light
          - switch.bath_room_switch
  mode: single

turn_off_all_presences:
  alias: Turn Off All Presences
  sequence:
    - service: input_boolean.turn_off
      target:
        entity_id:
          - input_boolean.bar_presence
          - input_boolean.bath_room_presence
          - input_boolean.bed_room_presence
          - input_boolean.hallway_presence
          - input_boolean.kitchen_presence
          - input_boolean.living_room_presence
          - input_boolean.office_presence
          - input_boolean.toilet_presence
          - input_boolean.entrance_presence
          - input_boolean.dining_room_presence
  mode: single

turn_off_all_music:
  alias: Turn Off All Music
  sequence:
    - service: media_player.media_pause
      target:
        entity_id:
          - media_player.kitchen_speaker
          - media_player.living_room_speaker
          - media_player.bath_room_speaker
          - media_player.office_speaker
          - media_player.bed_room_speaker
  mode: single

turn_off_all_presence_locks:
  alias: Turn Off All Presence Locks
  sequence:
    - service: input_boolean.turn_off
      target:
        entity_id:
          - input_boolean.bar_presence_lock
          - input_boolean.bath_room_presence_lock
          - input_boolean.bed_room_presence_lock
          - input_boolean.hallway_presence_lock
          - input_boolean.kitchen_presence_lock
          - input_boolean.living_room_presence_lock
          - input_boolean.office_presence_lock
          - input_boolean.toilet_presence_lock
          - input_boolean.entrance_presence_lock
  mode: single

say_goodbye:
  alias: Say goodbye in the kitchen
  sequence:
    - service: tts.cloud_say
      data:
        entity_id: media_player.kitchen_speaker
        message: Goodbye
        cache: true
    - delay:
        seconds: 1
    - wait_template: "{{ not(is_state('media_player.kitchen_speaker', 'playing')) }}"

set_trash_reminder:
  alias: Sets a trash reminder
  sequence:
    - if:
        - condition: state
          entity_id: input_boolean.trash_reminder
          state: "off"
      then:
        - service: input_boolean.turn_on
          target:
            entity_id:
              - input_boolean.trash_reminder
        - service: tts.cloud_say
          data:
            entity_id: media_player.kitchen_speaker
            message: Set trash reminder
            cache: true
        - delay:
            seconds: 1
        - wait_template: "{{ not(is_state('media_player.kitchen_speaker', 'playing')) }}"
      else:
        - service: input_boolean.turn_off
          target:
            entity_id:
              - input_boolean.trash_reminder
        - service: tts.cloud_say
          data:
            entity_id: media_player.kitchen_speaker
            message: Removed trash reminder
            cache: true
        - delay:
            seconds: 1
        - wait_template: "{{ not(is_state('media_player.kitchen_speaker', 'playing')) }}"

remind_about_trash:
  alias: Remind the user to take the trash out if the reminder has been set
  sequence:
    - if:
        - condition: state
          entity_id: input_boolean.trash_reminder
          state: "on"
      then:
        - service: tts.cloud_say
          data:
            entity_id: media_player.kitchen_speaker
            message: Remember to take out the trash
            cache: true
        - delay:
            seconds: 1
        - wait_template: "{{ not(is_state('media_player.kitchen_speaker', 'playing')) }}"
        - service: input_boolean.turn_off
          target:
            entity_id:
              - input_boolean.trash_reminder
