toggle_open_living_room_window:
  alias: Toggle Open Living Room Window
  sequence:
    - choose:
      - conditions:
        - condition: state
          entity_id: binary_sensor.living_room_window_closing
          state: 'on'
        sequence: []
      - conditions:
        - condition: state
          entity_id: binary_sensor.living_room_window_opening
          state: 'on'
        sequence:
          - service: cover.stop_cover
            target:
              entity_id: cover.living_room_window
      - conditions:
        - condition: state
          entity_id: binary_sensor.living_room_window_opening
          state: 'off'
        sequence:
          - service: script.open_living_room_window
      default: []
  mode: single

toggle_close_living_room_window:
  alias: Toggle Close Living Room Window
  sequence:
    - choose:
      - conditions:
        - condition: state
          entity_id: binary_sensor.living_room_window_opening
          state: 'on'
        sequence: []
      - conditions:
        - condition: state
          entity_id: binary_sensor.living_room_window_closing
          state: 'on'
        sequence:
          - service: cover.stop_cover
            target:
              entity_id: cover.living_room_window
      - conditions:
        - condition: state
          entity_id: binary_sensor.living_room_window_closing
          state: 'off'
        sequence:
          - service: script.close_living_room_window
      default: []
  mode: single

open_living_room_window:
  alias: Open Living Room Window
  sequence:
    - choose:
      - conditions:
        - condition: state
          entity_id: binary_sensor.living_room_window_closing
          state: 'off'
        - condition: state
          entity_id: binary_sensor.living_room_window_opening
          state: 'off'
        sequence:
          - service: cover.open_cover
            target:
              entity_id: cover.living_room_window
      default:
        - service: notify.telegram
          data:
            message: Error trying to open the window
            title: Window Error
  mode: single

close_living_room_window:
  alias: Close Living Room Window
  sequence:
    - choose:
      - conditions:
        - condition: state
          entity_id: binary_sensor.living_room_window_closing
          state: 'off'
        - condition: state
          entity_id: binary_sensor.living_room_window_opening
          state: 'off'
        sequence:
          - service: cover.close_cover
            target:
              entity_id: cover.living_room_window
      default:
        - service: notify.telegram
          data:
            message: Error trying to close the window
            title: Window Error
  mode: single

fully_close_living_room_window:
  alias: Fully Close Living Room Window
  sequence:
    - service: script.close_living_room_window
    - condition: state
      entity_id: binary_sensor.living_room_window_closing
      state: 'on'
    - delay:
        seconds: 25
    - service: cover.stop_cover
      target:
        entity_id: cover.living_room_window
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.living_room_window_open
  mode: single

fully_open_living_room_window:
  alias: Fully Open Living Room Window
  sequence:
    - service: script.open_living_room_window
    - condition: state
      entity_id: binary_sensor.living_room_window_opening
      state: 'on'
    - delay:
        seconds: 25
    - service: cover.stop_cover
      target:
        entity_id: cover.living_room_window
    - service: input_boolean.turn_on
      target:
        entity_id: input_boolean.living_room_window_open
  mode: single

warn_about_open_windows:
  alias: Warn about open windows
  sequence:
    - if:
        - condition: state
          entity_id: input_boolean.warn_windows_open
          state: "on"
      then:
        - if:
            - condition: state
              entity_id: binary_sensor.bed_room_window
              state: "on"
          then:
            - service: tts.cloud_say
              data:
                entity_id: media_player.kitchen_speaker
                message: Bed room window is open
                cache: true
            - delay:
                seconds: 3

        - if:
            - condition: state
              entity_id: binary_sensor.bath_room_window
              state: "on"
          then:
            - service: tts.cloud_say
              data:
                entity_id: media_player.kitchen_speaker
                message: Bath room window is open
                cache: true
            - delay:
                seconds: 3
        - if:
            - condition: state
              entity_id: binary_sensor.office_window
              state: "on"
          then:
            - service: tts.cloud_say
              data:
                entity_id: media_player.kitchen_speaker
                message: Office window is open
                cache: true
            - delay:
                seconds: 3
