office_speaker_join_group:
  alias: Office Speaker Join Group
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.bath_room_speaker_group_leader
        state: 'on'
      sequence:
        - service: media_player.join
          data:
            group_members:
              - media_player.office_speaker
          target:
            entity_id: media_player.bath_room_speaker
    - conditions:
      - condition: state
        entity_id: binary_sensor.kitchen_speaker_group_leader
        state: 'on'
      sequence:
        - service: media_player.join
          data:
            group_members:
              - media_player.office_speaker
          target:
            entity_id: media_player.kitchen_speaker
    - conditions:
      - condition: state
        entity_id: binary_sensor.living_room_speaker_group_leader
        state: 'on'
      sequence:
        - service: media_player.join
          data:
            group_members:
              - media_player.office_speaker
          target:
            entity_id: media_player.living_room_speaker
    default: []
  mode: single

office_speaker_toggle_grouping:
  alias: Office Speaker Toggle Grouping
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.office_speaker_in_group
        state: 'off'
      sequence:
      - service: script.office_speaker_join_group
    default:
    - service: media_player.unjoin
      target:
        entity_id: media_player.office_speaker
  mode: queued
