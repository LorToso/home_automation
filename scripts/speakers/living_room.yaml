living_room_speaker_join_group:
  alias: Living Room Speaker Join Group
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.bath_room_speaker_group_leader
        state: 'on'
      sequence:
      - service: sonos.join
        data:
          master: media_player.bath_room_speaker
          entity_id: media_player.living_room_speaker
    - conditions:
      - condition: state
        entity_id: binary_sensor.kitchen_speaker_group_leader
        state: 'on'
      sequence:
      - service: sonos.join
        data:
          master: media_player.kitchen_speaker
          entity_id: media_player.living_room_speaker
    - conditions:
      - condition: state
        entity_id: binary_sensor.office_speaker_group_leader
        state: 'on'
      sequence:
      - service: sonos.join
        data:
          master: media_player.office_speaker
          entity_id: media_player.living_room_speaker
    default: []
  mode: single

living_room_speaker_toggle_grouping:
  alias: Living Room Speaker Toggle Grouping
  sequence:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.living_room_speaker_in_group
        state: 'off'
      sequence:
      - service: script.living_room_speaker_join_group
    default:
    - service: sonos.unjoin
      target:
        entity_id: media_player.living_room_speaker
  mode: queued
