---
logger:
  module: logger
  class: Logger

living_room_switch:
  module: living_room_switch
  class: LivingRoomSwitch
  dependencies: 
    - living_room_retro_lamp
    - living_room_corner_lamp
    - living_room_head_lamp
    - living_room_motion_activation_boolean

  switch_device_id: e70207e80c0b11ebaf5719ccebfd3949
  retro_lamp: living_room_retro_lamp
  corner_lamp: living_room_corner_lamp
  head_lamp: living_room_head_lamp
  motion_sensor_activation: living_room_motion_activation_boolean

living_room_retro_lamp:
  module: hue_lamp
  class: HueLamp
  entity_id: light.living_room_retro_lamp
  default_min_brightness: 20
  default_max_brightness: 220

living_room_corner_lamp:
  module: hue_lamp
  class: HueLamp
  entity_id: light.living_room_corner_lamp
  default_min_brightness: 100
  default_max_brightness: 254

living_room_head_lamp:
  module: lamp_multiplexer_app
  class: LampMultiplexerApp
  dependencies:
    - living_room_head_lamp_1
    - living_room_head_lamp_2
    - living_room_head_lamp_3
    - living_room_head_lamp_4
    - living_room_head_lamp_5

  default_min_brightness: 20
  default_max_brightness: 254
  attributes: {transition: 0}
  lamps:
    - living_room_head_lamp_1
    - living_room_head_lamp_2
    - living_room_head_lamp_3
    - living_room_head_lamp_4
    - living_room_head_lamp_5

living_room_head_lamp_1:
  module: hue_lamp
  class: HueLamp
  entity_id: light.living_room_head_lamp_1
  default_min_brightness: 25
  default_max_brightness: 254

living_room_head_lamp_2:
  module: hue_lamp
  class: HueLamp
  entity_id: light.living_room_head_lamp_2
  default_min_brightness: 25
  default_max_brightness: 254

living_room_head_lamp_3:
  module: hue_lamp
  class: HueLamp
  entity_id: light.living_room_head_lamp_3
  default_min_brightness: 25
  default_max_brightness: 254

living_room_head_lamp_4:
  module: hue_lamp
  class: HueLamp
  entity_id: light.living_room_head_lamp_4
  default_min_brightness: 25
  default_max_brightness: 254

living_room_head_lamp_5:
  module: hue_lamp
  class: HueLamp
  entity_id: light.living_room_head_lamp_5
  default_min_brightness: 25
  default_max_brightness: 254

living_room_speaker:
  module: default_sonos_speaker
  class: DefaultSonosSpeaker
  entity_id: media_player.living_room_speaker

  dependencies: sonos_group
  speaker_group: sonos_group
  default_volume: 0.12

living_room_motion_light_controller:
  module: motion_multiplexing_light_controller
  class: MotionMultiplexingLightController

  dependencies:
    - living_room_motion_activation_boolean
    - living_room_retro_lamp
    - living_room_corner_lamp

  motion_entity_id: binary_sensor.living_room_motion
  activation_boolean:
    - living_room_motion_activation_boolean
  lamps:
    - {app_name: living_room_corner_lamp}
    - {app_name: living_room_retro_lamp}
  turn_light_off_after_seconds: 1800
  ignore_brightness: false

living_room_motion_music_controller:
  module: motion_music_controller
  class: MotionMusicController

  dependencies:
    - living_room_motion_activation_boolean
    - music_following_input_boolean
    - living_room_speaker

  motion_entity_id: binary_sensor.living_room_motion
  activation_boolean:
    - living_room_motion_activation_boolean
    - music_following_input_boolean
  speaker: living_room_speaker
  turn_music_off_after_seconds: 180
  ignore_brightness: false

living_room_motion_activation_boolean:
  module: motion_sensor_activation_boolean
  class: MotionSensorActivationBoolean
  dependencies: living_room_speaker

  entity_id: input_boolean.living_room_motion_activation
  speaker: living_room_speaker


bed_room_head_lamp:
  module: hue_lamp
  class: HueLamp
  entity_id: light.bedroom_head_light
  default_min_brightness: 20
  default_max_brightness: 254
  attributes: {transition: 0}

bed_room_night_lamp:
  module: bed_room_night_lamp
  class: BedRoomNightLamp
  entity_id: light.bedroom_night_lamp
  default_min_brightness: 20
  default_max_brightness: 254

bed_room_switch:
  module: bed_room_switch
  class: BedRoomSwitch

  dependencies:
    - bed_room_head_lamp
    - bed_room_night_lamp
    - bed_room_motion_activation_boolean

  switch_device_id: 6478c2810af711ebad38135e2ad28f01
  head_lamp: bed_room_head_lamp
  night_lamp: bed_room_night_lamp
  motion_activation_boolean: bed_room_motion_activation_boolean

bed_room_night_switch:
  module: bed_room_night_switch
  class: BedRoomNightSwitch
  dependencies: 
    - bed_room_head_lamp
    - bed_room_night_lamp
    - night_mode_input_boolean

  switch_device_id: aba7647ac6470849cea271f62559e2db
  head_lamp: bed_room_head_lamp
  night_lamp: bed_room_night_lamp
  night_mode: night_mode_input_boolean

bed_room_speaker:
  module: default_sonos_speaker
  class: DefaultSonosSpeaker
  entity_id: media_player.bedroom_speaker

  dependencies: sonos_group
  speaker_group: sonos_group
  default_volume: 0.1

bed_room_motion_light_controller:
  module: motion_multiplexing_light_controller
  class: MotionMultiplexingLightController

  dependencies:
    - bed_room_motion_activation_boolean,
    - night_mode_input_boolean
    - bed_room_head_lamp
    - bed_room_night_lamp

  motion_entity_id: binary_sensor.bed_room_motion_sensor
  activation_boolean:
    - bed_room_motion_activation_boolean
    - not:night_mode_input_boolean
  lamps:
    - {app_name: bed_room_night_lamp, start_time: '00:00:00', end_time: '07:00:00'}
    - {app_name: bed_room_head_lamp, start_time: '07:00:00', end_time: '23:00:00'}
    - {app_name: bed_room_night_lamp, start_time: '23:00:00', end_time: '23:59:59'}
  turn_light_off_after_seconds: 180
  ignore_brightness: false

bed_room_motion_music_controller:
  module: motion_music_controller
  class: MotionMusicController

  dependencies:
    - bed_room_motion_activation_boolean
    - music_following_input_boolean
    - night_mode_input_boolean
    - bed_room_speaker

  motion_entity_id: binary_sensor.bed_room_motion_sensor
  activation_boolean:
    - bed_room_motion_activation_boolean
    - music_following_input_boolean
    - not:night_mode_input_boolean
  speaker: bed_room_speaker
  turn_music_off_after_seconds: 180
  ignore_brightness: false

bed_room_motion_activation_boolean:
  module: motion_sensor_activation_boolean
  class: MotionSensorActivationBoolean
  dependencies: bed_room_speaker

  entity_id: input_boolean.bed_room_motion_activation_boolean
  speaker: bed_room_speaker


bath_room_lamp:
  module: conditional_lamp
  class: ConditionalLamp
  entity_id: light.bathroom_lamp
  default_min_brightness: 20
  attributes: {transition: 0}

  conditions:
    - {start_time: "00:00:00", end_time: "07:00:00", brightness: 25}
    - {start_time: "07:00:00", end_time: "10:00:00", brightness: 130}
    - {start_time: "10:00:00", end_time: "20:00:00", brightness: 225}
    - {start_time: "20:00:00", end_time: "23:59:59", brightness: 110}


bath_room_switch:
  module: default_tradfri_switch
  class: DefaultTradfriSwitch
  dependencies: [bath_room_lamp, bath_room_motion_activation_boolean]

  switch_device_id: 9b3e76b9ecc6f0da93331aae0a3b5d61
  lamp: bath_room_lamp
  motion_activation_boolean: bath_room_motion_activation_boolean

bath_room_motion_light_controller:
  module: motion_light_controller
  class: MotionLightController

  dependencies:
    - bath_room_motion_activation_boolean
    - bath_room_lamp

  motion_entity_id: binary_sensor.bathroom_motion
  activation_boolean: bath_room_motion_activation_boolean
  lamp: bath_room_lamp
  turn_light_off_after_seconds: 180
  ignore_brightness: true

bath_room_motion_music_controller:
  module: motion_music_controller
  class: MotionMusicController

  dependencies:
    - bath_room_motion_activation_boolean
    - music_following_input_boolean
    - bath_room_speaker

  motion_entity_id: binary_sensor.bathroom_motion
  activation_boolean:
    - bath_room_motion_activation_boolean
    - music_following_input_boolean
  speaker: bath_room_speaker
  turn_music_off_after_seconds: 180

bath_room_motion_activation_boolean:
  module: motion_sensor_activation_boolean
  class: MotionSensorActivationBoolean
  dependencies: bath_room_speaker

  entity_id: input_boolean.bath_room_motion_activation_boolean
  speaker: bath_room_speaker

bath_room_speaker:
  module: default_sonos_speaker
  class: DefaultSonosSpeaker
  entity_id: media_player.bathroom_speaker

  dependencies: sonos_group
  speaker_group: sonos_group
  default_volume: 0.15


kitchen_lamp:
  module: hue_lamp
  class: HueLamp
  entity_id: light.kitchen_lamp
  default_min_brightness: 100
  #default_max_brightness: 254
  attributes: {transition: 0}

kitchen_switch:
  module: default_tradfri_switch
  class: DefaultTradfriSwitch
  dependencies: kitchen_lamp

  switch_device_id: c7c68a1be32ca26a7050e4f5937ee1c9
  lamp: kitchen_lamp
  motion_activation_boolean: kitchen_motion_activation_boolean

kitchen_motion_light_controller:
  module: motion_light_controller
  class: MotionLightController

  dependencies:
    - kitchen_motion_activation_boolean
    - kitchen_lamp

  motion_entity_id: binary_sensor.kitchen_motion
  activation_boolean: kitchen_motion_activation_boolean
  lamp: kitchen_lamp
  turn_light_off_after_seconds: 240
  ignore_brightness: false

kitchen_motion_music_controller:
  module: motion_music_controller
  class: MotionMusicController

  dependencies:
    - kitchen_motion_activation_boolean
    - music_following_input_boolean
    - kitchen_speaker

  motion_entity_id: binary_sensor.kitchen_motion
  activation_boolean:
    - kitchen_motion_activation_boolean
    - music_following_input_boolean
  speaker: kitchen_speaker
  turn_music_off_after_seconds: 240

kitchen_motion_activation_boolean:
  module: motion_sensor_activation_boolean
  class: MotionSensorActivationBoolean
  dependencies: kitchen_speaker

  entity_id: input_boolean.kitchen_motion_activation_boolean
  speaker: kitchen_speaker

kitchen_speaker:
  module: default_sonos_speaker
  class: DefaultSonosSpeaker
  entity_id: media_player.kitchen_speaker

  dependencies: sonos_group
  speaker_group: sonos_group
  default_volume: 0.2


hallway_lamp:
  module: hue_lamp
  class: HueLamp
  entity_id: light.hallway_lamp
  default_min_brightness: 100
  #default_max_brightness: 254
  attributes: {transition: 0}

hallway_switch:
  module: default_tradfri_switch
  class: DefaultTradfriSwitch
  dependencies:
    - hallway_lamp
    - hallway_motion_activation_boolean

  switch_device_id: 9e6b45d0e350c2c3e0e87a880ee576e9
  lamp: hallway_lamp
  motion_activation_boolean: hallway_motion_activation_boolean

hallway_motion_activation_boolean:
  module: motion_sensor_activation_boolean
  class: MotionSensorActivationBoolean
  dependencies: kitchen_speaker

  entity_id: input_boolean.hallway_motion_activation_boolean
  speaker: kitchen_speaker

hallway_motion_light_controller:
  module: motion_light_controller
  class: MotionLightController

  dependencies:
    - hallway_motion_activation_boolean
    - hallway_lamp

  motion_entity_id: binary_sensor.hallway_motion
  activation_boolean: hallway_motion_activation_boolean
  lamp: hallway_lamp
  turn_light_off_after_seconds: 50
  ignore_brightness: false


sonos_group:
  module: sonos_group
  class: SonosGroup

  speaker_priority:
    - media_player.bedroom_speaker
    - media_player.kitchen_speaker
    - media_player.bathroom_speaker
    - media_player.living_room_speaker


lamp_group:
  module: lamp_group
  class: LampGroup

  dependencies:
    - living_room_retro_lamp
    - living_room_corner_lamp
    - bed_room_head_lamp
    - bed_room_night_lamp
    - bath_room_lamp
    - kitchen_lamp
    - living_room_head_lamp

  lamps:
    - living_room_retro_lamp
    - living_room_corner_lamp
    - bed_room_head_lamp
    - bed_room_night_lamp
    - bath_room_lamp
    - kitchen_lamp
    - living_room_head_lamp

#guest_mode_notification:
#  module: guest_mode_notification
#  class: GuestModeNotification

guest_mode_input_boolean:
  module: input_boolean
  class: InputBoolean
  entity_id: input_boolean.guest_mode_boolean

music_following_input_boolean:
  module: input_boolean
  class: InputBoolean
  entity_id: input_boolean.music_following

night_mode_input_boolean:
  module: night_mode_boolean
  class: NightModeBoolean
  entity_id: input_boolean.night_mode

phone_presence:
  module: phone_presence
  class: PhonePresence
  dependencies:
    - lamp_group

  entity_id: device_tracker.htc_u11
  lamp_group: lamp_group

